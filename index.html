<!DOCTYPE html>
<html><head>
  <title>Thomas Gauthier-Caron - Ad venture â€” Play</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <meta name="author" content="Thomas Gauthier-Caron">
  <link rel="stylesheet" href="assets/style.css">

  <link rel="stylesheet" href="assets/glkote.css" type="text/css">
  <link rel="stylesheet" href="assets/dialog.css" type="text/css">
  <script src="assets/glkote.js" type="text/javascript"></script>
  <script src="assets/quixe.js" type="text/javascript"></script>
  <script src="assets/jquery-2.js"></script>
  <script>jQuery.noConflict();</script>
  <script src="assets/key-event.js" type="text/javascript"></script>



  <script>

  var talkShop = false;

  setInterval(function(){
    var val = document.getElementsByTagName('input')[0].value;

    document.getElementsByTagName('input')[0].addEventListener("keypress", function(event){
      if (event.which == 13 || event.keyCode == 13) {
      //  event.preventDefault();
      //  event.stopPropagation();
        if(talkShop){
          enterInput('go east');


          var game =  document.getElementById("windowport").children[1];

          for (var i = game.children.length-1; i >=0 ; i--){
            if( game.children[i].innerHTML.indexOf("can't see") > -1){
              game.children[i].style.display = 'none';
            }
          }

        }
      }
    });

    var testVal = val.toLowerCase();
    if(testVal.indexOf('shop') >= 0){
        talkShop = true;
      // var outerHTML = document.getElementsByTagName('input')[0].outerHTML
      // document.getElementsByTagName('input')[0].outerHTML = outerHTML+outerHTML
      // document.getElementsByTagName('input')[0].style = "display:none";
      // document.getElementsByTagName('input')[1].id = ""
      //
      //
      // document.getElementsByTagName('input')[0].value = "go east";
      // document.getElementsByTagName('input')[1].value = val;

    }else{
      talkShop = false;
    }
  }, 10);
  // var bo = document.getElementsByTagName('input')[0].outerHTML
  // document.getElementsByTagName('input')[0].outerHTML = bo+bo
  // document.getElementsByTagName('input')[0].type = "hidden"

  inputs = [];

  function popitup(url, width, height) {
    newwindow = window.open(url, 'flashlight','toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=900,height=900');
    if (window.focus) {newwindow.focus()}
    return false;
  }


  function changeAd(command){
    console.log(command);

    if(command.indexOf("Dark Room") > -1){
      var game =  document.getElementById("windowport").children[1];

      document.getElementById("upper-ad").src="images/flashlight.gif";
        game.lastChild.previousSibling.previousSibling.innerHTML =  game.lastChild.previousSibling.previousSibling.innerHTML.replace('_bright', 'bright');
      game.lastChild.scrollIntoView();

    }

    if(command.indexOf("It seems to be locked.") > -1){
      document.getElementById("lefty-ad").src="images/locksmith.png";
    }

    if(command.indexOf("Boss Room") > -1){
      document.getElementById("upper-ad").src="images/cheat.jpg";
    }


  }

  function enterInput(inp){
    if(inputs.indexOf(inp) < 0){
      var game =  document.getElementById("windowport").children[1];

      var input = game.lastChild.getElementsByTagName('input')[0];
      input = jQuery(input);


      input.val(inp);
      input.trigger ( {
        type: 'keypress', keyCode: 13, which: 13, charCode: 13
      } );


      for (i = 0; i < game.children.length; i++){
        if( game.children[i].innerHTML.indexOf(inp) > -1){
          game.children[i].style.display = 'none';
          break;
        }

      }


      inputs.push(inp);
    }




  }

  window.onload = function(){

    jQuery("#upper-ad").click(function(){

      if (document.getElementById("upper-ad").src.indexOf("images/flashlight.gif") > -1){
        popitup('popup.html', 600, 600);
        enterInput("take flashylought");
      }

      if (document.getElementById("upper-ad").src.indexOf("images/cheat.jpg") > -1){
        popitup('popup2.html', 960, 960);
        enterInput("take flashylought");
      }

      if (document.getElementById("upper-ad").src.indexOf("images/castleempire.jpg") > -1){
        var win = window.open('http://www.thesettlersonline.net', '_blank');
        win.focus();
      }

    });

    jQuery("#lefty-ad").click(function(){

      if (document.getElementById("lefty-ad").src.indexOf("images/locksmith.png") > -1){
        enterInput("bouha");
      }
      if (document.getElementById("lefty-ad").src.indexOf("images/160-1.png") > -1){
        var win = window.open('http://warflare.gamebox.com/', '_blank');
        win.focus();
      }



    });





    document.onkeypress = function(event) {
      if (event.keyCode == 13){
        game =  document.getElementById("windowport").children[1];
        var last = null;
        for(var i = game.children.length-1; i >= 0; i--){
          if(game.children[i].getElementsByClassName("Style_input")[0] != undefined){
            last = i;
            break;
          }
        }
        var command = "";
        for(var i = last; i <= game.children.length-2; i++){
          //bob += game.children[i].children[0].innerHTML;
          if(game.children[i].children[0]){
            command += game.children[i].children[0].innerHTML + '\n';
          }
        }
        changeAd(command);
      }
    }
  }
  </script>
  <script type="text/javascript">
  game_options = {
    use_query_story: false,
    set_page_title: false,
    inspacing: 0,     // gap between windows
    outspacing: 0     // gap between windows and edge of gameport
  };
  </script>

  <script src="assets/Ad_venture.js" type="text/javascript"></script>

</head>
<body class="play">
  <div class="container">
    <div class="ad" ><span><img src="assets/160-1.png" id="lefty-ad" border="1"/></span></div>


    <div class="ad"><span><img id="upper-ad" src="assets/castleempire.jpg" border="1"/></span></div>



    <div id="gameport">

      <div id="windowport"><div style="left: 0px; top: 0px; right: 0px; bottom: 451px;" class="WindowFrame GridWindow WindowRock_202" id="window721"><div class="GridLine" id="win721_ln0"><span class="Style_normal"> Dungeon Entrance                                                                                 </span></div></div><div style="left: 0px; top: 29px; right: 0px; bottom: 0px;" class="WindowFrame BufferWindow WindowRock_201" id="window719"><div class="BufferLine">&nbsp;</div><div class="BufferLine">&nbsp;</div><div class="BufferLine"><span class="Style_header">Ad venture</span></div><div class="BufferLine"><span class="Style_normal">An Interactive Fiction by Thomas Gauthier-Caron</span></div><div class="BufferLine"><span class="Style_normal">Release 1 / Serial number 141030 / Inform 7 build 6L38 (I6/v6.33 lib 6/12N) </span></div><div class="BufferLine">&nbsp;</div><div class="BufferLine"><span class="Style_subheader">Dungeon Entrance</span></div><div class="BufferLine"><span class="Style_normal">You
        are at the Dungeon Entrance on your way for a great adventure. You are a
        little nervous and you almost forget that you need to equip yourself
        before going on this quest. Fortunately you see a door written
        "Adventurer shop" right before you.</span></div><div class="BufferLine">&nbsp;</div><div class="BufferLine"><span class="Style_normal">&gt;</span><span class="InvisibleCursor" id="win719_cursor">&nbsp;<input style="position: absolute; left: 0px; top: 0px; width: 679px;" maxlength="256" class="Input LineInput" id="win719_input" type="text"></span></div></div></div>
        <div style="display: none;" id="loadingpane">
          <img src="assets/waiting.gif" alt="LOADING"><br>
          <em>&nbsp;&nbsp;&nbsp;Loading...</em>
        </div>
        <div id="errorpane" style="display:none;"><div id="errorcontent">...</div></div>
        <div id="layouttestpane">
          This should not be visible
          <div id="layouttest_grid" class="WindowFrame GridWindow"><div id="layouttest_gridline" class="GridLine"><span id="layouttest_gridspan" class="Style_normal">12345678</span></div><div id="layouttest_gridline2" class="GridLine"><span class="Style_normal">12345678</span></div></div>
          <div id="layouttest_buffer" class="WindowFrame BufferWindow"><div id="layouttest_bufferline" class="BufferLine"><span id="layouttest_bufferspan" class="Style_normal">12345678</span></div><div id="layouttest_bufferline2" class="BufferLine"><span class="Style_normal">12345678</span></div></div>
        </div>
      </div>

    </div>
    <div class="interpretercredit"><a href="http://eblong.com/zarf/glulx/quixe/">Quixe for Inform 7 (v. 1.3.1)</a></div>



  </body></html>
